<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vite App</title>
</head>

<body>
  <div id="overlay"></div>
  <div id="canvasAndNav">
    <div id="app">
      <div class="sceneNav">
        <div id="intro-chat">
          <img id="avatar" src="public/image.png" />
          <div id="chatBubble">
            <h1 id="intro"></h1>
          </div>
        </div>
        <div id="options">
          <a id="main-nav" href="#about">About</a>
          <a id="main-nav" href="#resume">Resume</a>
          <a id="main-nav" href="#projects">Projects</a>
          <a id="main-nav" class="contact" href="#contact">Contact</a>
        </div>

      </div>
    </div>

    <div id="loading-bar-container">
      <h2 id="loading-text">Loading...</h2>
      <div id="loading-bar">
        <div class="progress"></div>
      </div>
    </div>
    <canvas class="webgl"></canvas>
  </div>
  <div class="containerForPadding">
    <div class="info">
      <div id="about" class="section">
        <div id="description">
          <h2 id="subTitle">About</h2>
          <p id="description-p"> I'm Zain Zulfiqar, a Computer Science student at Rutgers University and a budding
            software engineer. With a strong grasp
            on languages like Javascript and Java, I've honed my skills through participation in HackRU hackathons,
            creating an
            award-winning NJ Transit Chatbot, and leading the development of Major News, an app aggregating personalized
            news
            content for college students. Additionally, as the Education Director for Software Engineering Track at
            Rutgers
            Blueprint, I've been privileged to foster coding proficiency among fellow undergraduates. On my free time I
            like to grapple in Jiu Jitsu with friends
            (I'm a blue belt) and go to the gym.
          </p>
        </div>
        <div id="imgContainer">
          <img src="public/Me.jpeg" />
        </div>
      </div>
      <div id="resume" class="section">
        <h2>Resume</h2>
        <iframe src="https://drive.google.com/file/d/1Og3zV2KVfGpkg_0fyV7ame8LjYlV4GgG/preview" width="640" height="480"
          allow="autoplay"></iframe>

      </div>
      <div id="background-image">
        <div id="projects" class="section">
          <h2 id="subTitle">Projects</h2>
          <div id="description-grid">
            <div id="card1" class="card">
              <div class="container">
                <img id="card-content" src="public/websiteDisplay.jpeg" />
                <div class="card-buttons">
                  <a href="https://github.com/TherealZain/My-Website">
                    <button>View Code <i class="fa-solid fa-arrow-up-right-from-square fa-2xs"
                        style="color: #fdf7e3;"></i></button>
                  </a>
                </div>
                <div class="card-skills">
                  <i class="fa-brands fa-html5 fa-2xl" style="color: #0c162a;"></i>
                  <i class="fa-brands fa-css3-alt fa-2xl" style="color: #0c162a;"></i>
                  <i class="fa-brands fa-square-js fa-2xl" style="color: #0c162a;"></i>
                </div>
                <h4>Portfolio</h4>
                <p id="description-project">This website showcases my experience with web development. I've used HTML,
                  CSS, and JavaScript, along with the Three.js
                  library for adding 3D models and animations. The website is designed to adapt to different screen
                  sizes, making it
                  user-friendly across various devices. It was an enjoyable project, where I learned a lot about 3D
                  modeling on
                  websites. I'm pleased to share it as a reflection of my work and creativity.
                </p>

              </div>

            </div>
            <div id="card2" class="card">
              <div class="container">
                <iframe id="card-video" width="560" height="315" src="https://www.youtube.com/embed/hhXVOwOCS1o"
                  title="YouTube video player" frameborder="0"
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                  allowfullscreen></iframe>
                <div class="card-buttons">
                  <a href="https://github.com/TherealZain/Nate-the-Transit-Mate" target="_blank">
                    <button>View Code <i class="fa-solid fa-arrow-up-right-from-square fa-2xs"
                        style="color: #fdf7e3;"></i></button>
                  </a>
                  <a href="https://devpost.com/software/nate-the-transit-mate" target="_blank">
                    <button>Project <i class="fa-solid fa-arrow-up-right-from-square fa-2xs"
                        style="color: #fdf7e3;"></i></button>
                  </a>
                </div>
                <div class="card-skills">
                  <img src="public/dialogflow-icon.svg" />
                  <i class="fa-brands fa-square-js fa-2xl" style="color: #0c162a;"></i>
                </div>
                <h4>Nate the Transit Mate</h4>
                <p id="description-project">This acclaimed project was an outcome of a collaborative effort in a 24-hour
                  hackathon. Our team of four utilized
                  JavaScript/Express.js and Google Cloud's Dialogflow API to develop an intelligent chatbot for NJ
                  Transit. The chatbot was designed
                  to responsively answer user queries regarding bus/train routes and frequently asked questions. My
                  contributions spanned
                  from designing the chatbot's interface to orchestrating the backend, and teaching the chatbot to
                  respond to diverse
                  questions.
                </p>

              </div>

            </div>
            <div id="card3" class="card">
              <div class="container">
                <img id="major-news" src="public/majornews.jpeg" />
                <div class="card-buttons">
                  <a href="https://github.com/TherealZain/MajorNewsData" target="_blank">
                    <button>View Code <i class="fa-solid fa-arrow-up-right-from-square fa-2xs"
                        style="color: #fdf7e3;"></i></button>
                  </a>
                </div>
                <div class="card-skills">
                  <i class="fa-brands fa-python fa-2xl" style="color: #0c162a;"></i>
                  <i class="fa-brands fa-swift fa-2xl" style="color: #0c162a;"></i>
                </div>
                <h4>Major News</h4>
                <p id="description-project">
                  In a team of four, we've crafted a news application tailored to college students, which aggregates
                  pertinent to
                  their majors from a range of sources including CNN, Investopedia, and Techcrunch. The main
                  technologies used were
                  Python, Flask for the backend and Swift for the frontend.
                  The project is in the enhancement phase My key responsibilities included constructing a REST API to
                  provide accessible data to the frontend, and
                  integrating the frontend with the backend.

                </p>
              </div>

            </div>



          </div>



        </div>
        <div id="contact">
          <form id="myForm" method="post" action="https://formspree.io/f/xrgvwkzl">
            <h2 id="contact-headline">Contact Me</h2>
            <div id="form-info">
              <div id="person-info">
                <input type="text" id="honeypot" name="_gotcha" style="display:none">
                <label for="name">Name:</label>
                <input type="text" name="name" id="name" placeholder="Enter your Name" required>


                <label for="email">Email:</label>
                <input type="email" name="email" id="email" placeholder="Email" required>


                <label for="subject">Subject:</label>
                <input type="subject" name="subject" id="subject" placeholder="Subject">
              </div>
              <div id="message">
                <label for="message">Message:</label>
                <textarea name="message" id="text" placeholder="Enter your message"
                  oninput="adjustTextareaHeight()"></textarea>
              </div>

            </div>
            <input id="submit-button" type="submit" value="Submit">

          </form>
        </div>
      </div>
      <footer>
        <div id="icons">
          <a href="https://github.com/TherealZain" target="_blank" style="color: inherit">
            <i class="fa-brands fa-github fa-2xl"></i>
          </a>
          <a href="https://www.linkedin.com/in/zain-zulfiqar-9a3898181/" target="_blank" style="color: inherit">
            <i class="fa-brands fa-linkedin fa-2xl"></i>
          </a>
          <a href="https://www.youtube.com/@zainzulfiqar54/featured" target="_blank" style="color: inherit">
            <i class="fa-brands fa-youtube fa-2xl"></i>
          </a>
        </div>
        <div id="footer-nav">
          <a href="#about">About</a>
          <a href="#projects">Projects</a>
          <a href="#contact">Contact Me</a>
        </div>

      </footer>
    </div>
  </div>
  <script>
    import * as THREE from "three";
    import { OBJLoader } from "three/addons/loaders/OBJLoader.js";
    import { MTLLoader } from "three/addons/loaders/MTLLoader.js";
    import { GLTFLoader } from "three/addons/loaders/GLTFLoader.js";
    import { OrbitControls } from "three/examples/jsm/controls/OrbitControls.js";
    import { adjustModelScale } from "./scaleSize";
    import { adjustCameraPosition } from "./scaleSize";
    const scene = new THREE.Scene();
    let isLoaded = false;
    let loadedResources = 0;
    const camera = new THREE.PerspectiveCamera(
      55,
      window.innerWidth / window.innerHeight,
      0.1,
      1000
    );
    scene.add(camera);
    camera.position.z = 7;
    camera.position.y = 0.1;
    camera.position.x = 1.5;
    adjustCameraPosition(camera);

    const light = new THREE.PointLight(0xffffff, 10, 100);
    light.position.set(0, 20, 10);
    scene.add(light);
    const canvas = document.querySelector(".webgl");
    const renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.render(scene, camera);
    let loadedObject = null;
    const loader = new GLTFLoader();

    loader.load(
      "public/models/intergalactic_spaceship_only_model/scene.gltf",

      function (gltf) {
        loadedObject = gltf.scene;
        console.log("Model loaded successfully:", gltf);
        loadedObject.position.set(-250, 100, -800);
        loadedObject.rotation.x = (Math.PI / 16);
        loadedObject.rotation.y = Math.PI + 3.5;
        loadedObject.rotation.z = Math.PI + 3.0;
        adjustModelScale(loadedObject)
        scene.add(loadedObject);
        loadedResources++
        checkResourcesLoaded();
      },
      // called while loading is progressing
      function (xhr) {
        console.log((xhr.loaded / xhr.total) * 100 + "% loaded");

      },
      // called when loading has errors
      function (error) {
        console.log("An error happened");
      }
    );

    let starGeo;
    let starMaterial;

    starGeo = new THREE.BufferGeometry();
    const positions = [];
    const velocities = [];
    const accelerations = [];
    for (let i = 0; i < 6000; i++) {
      positions.push(
        Math.random() * 600 - 300,
        Math.random() * 600 - 300,
        Math.random() * 600 - 300
      );
      velocities.push(0);
      accelerations.push(0.02);
    }

    starGeo.setAttribute(
      "position",
      new THREE.Float32BufferAttribute(positions, 3)
    );

    let sprite = new THREE.TextureLoader().load("public/download.png", () => {
      console.log("stars are good")
      loadedResources++;
      checkResourcesLoaded();
    });
    starMaterial = new THREE.PointsMaterial({
      color: 0xaaaaaa,
      size: 0.7,
      map: sprite,
    });

    let stars = new THREE.Points(starGeo, starMaterial);
    scene.add(stars);
    const h1 = document.getElementById("intro");
    const text =
      "Hello, I'm Zain Zulfiqar, Software Engineer, Software developer and computer scientist.";
    let isTextTyped = false;
    console.log("here")
    const maxRotation = 0.006
    let movementDirection = 1; // 1 for right, -1 for left
    let isRotationDelayed = false; // Flag to track if rotation delay is active
    let timeoutStarted = false
    let rotationDuration = 1500;
    let rotationDelay = Math.random() * 3000; // Delay in milliseconds before rotation starts
    let oscillate = false;
    let rotationStartTime;
    const verticalAmplitude = 0.2; // Adjust the vertical amplitude
    const verticalFrequency = 0.002; // Adjust the vertical frequency
    const movementSpeed = 0.1; // Adjust the movement speed
    let rotationMultiplier = 1.2; // Adjust the rotation multiplier for the right side
    let rotationAmount;
    const starPositions = starGeo.attributes.position.array;
    const origin = new THREE.Vector3(0, 0, 0);
    let targetX = 0;
    let targetZ = 0;
    let targetY = 0;

    // Function to start the rotation after the delay
    function startRotation() {
      isRotationDelayed = true;
      rotationStartTime = Date.now();
    }
    function easeOutQuad(x) {
      return 1 - (1 - x) * (1 - x);
    }

    function animate() {
      if (!isLoaded) {
        // If the objects have not finished loading, wait for a short delay and check again
        console.log("not loaded");
        setTimeout(animate, 100);
        return;
      }

      requestAnimationFrame(animate);
      // Adjust the desired frame rate (e.g., 30 FPS)

      for (let i = 0; i < starPositions.length; i += 3) {
        velocities[i / 3] += accelerations[i / 3];
        starPositions[i + 2] -= velocities[i / 3];

        if (starPositions[i + 2] < -200) {
          starPositions[i + 2] = 200;
          velocities[i / 3] = 0;
        }
      }
      starGeo.attributes.position.needsUpdate = true;

      stars.rotation.z += 0.002;

      if (loadedObject) {
        let distanceX = loadedObject.position.x - targetX;
        let distanceY = loadedObject.position.y - targetY;
        let distanceZ = loadedObject.position.z - targetZ;

        // If the object's x-coordinate is close enough to the target, set it to exactly the target
        if (Math.abs(distanceX) < 0.001) {
          loadedObject.position.x = targetX;
          document.getElementById("app").style.display = "block";
          if (!isTextTyped) {
            isTextTyped = true;
            for (let i = 0; i < text.length; i++) {
              setTimeout(() => {
                h1.textContent += text[i];
              }, i * 45);
            }
          }
        } else {
          // Apply the ease-out function to the object's speed
          loadedObject.position.x -= distanceX * 0.1;
        }
        if (Math.abs(distanceZ) < 0.001) {
          loadedObject.position.z = targetZ;
          if (!isRotationDelayed) {
            setTimeout(startRotation, rotationDelay);
            rotationAmount = Math.random() * 0.006; // Adjust the rotation amount (in radians)
            if (rotationAmount > maxRotation) {
              rotationAmount = maxRotation * movementDirection;
            }
          }

          // Rotate the loaded object (model) within the duration
          if (isRotationDelayed && loadedObject) {
            const rotationTime = Date.now() - rotationStartTime;
            if (rotationTime <= rotationDuration) {
              let easedRotationAmount =
                rotationAmount * easeOutQuad(rotationTime / rotationDuration);
              loadedObject.rotation.z += easedRotationAmount * movementDirection;
            } else {
              // Stop the rotation after the specified duration
              let overtime = rotationTime - rotationDuration;
              let easedOvertimeRotationAmount =
                rotationAmount * (1 - overtime / (rotationDuration * 2));
              if (easedOvertimeRotationAmount < 0) {
                easedOvertimeRotationAmount = 0;
              }
              loadedObject.rotation.z +=
                easedOvertimeRotationAmount * movementDirection;



              if (easedOvertimeRotationAmount === 0) {
                isRotationDelayed = false;
                if (loadedObject.rotation.z > 6.4) {
                  movementDirection = -1;
                } else if (loadedObject.rotation.z < 5.7) {
                  movementDirection = 1;
                } else Math.random() >= 0.5 ? 1 : -1;
              }
            }
          }
        } else {
          loadedObject.position.z -= distanceZ * 0.1;
        }
        if (!oscillate) {
          loadedObject.position.y -= distanceY * 0.1;
          oscillate = true;
        } else {
          loadedObject.position.y =
            targetY + Math.sin(Date.now() * verticalFrequency) * verticalAmplitude;
        }
      }
      renderer.render(scene, camera);
    }

    animate();

    function typeOutText() {
      requestAnimationFrame(typeOutText);
      if (
        loadedObject &&
        loadedObject.position.distanceTo(origin) < 0.001 &&
        !isTextTyped
      ) {
        isTextTyped = true;
      }
      renderer.render(scene, camera);
    }

    typeOutText();
    // Assuming loadedObject is your 3D object
    let isDragging = false;
    let previousMousePosition = {
      x: 0,
      y: 0,
    };

    function checkResourcesLoaded() {
      if (loadedResources === 2) {
        // Both resources (sprite and model) have finished loading
        isLoaded = true;
      }
    }


    let ellipsisCount = 0;
    document.addEventListener("DOMContentLoaded", function () {
      startLoading();
    });

    function startLoading() {
      const loadingTime = 5000;
      const startTime = Date.now();

      const loadingInterval = setInterval(function () {
        const loadingBar = document.getElementById("loading-bar");
        const loadingText = document.getElementById("loading-text");
        const elapsed = Date.now() - startTime;

        const currentPercentage = Math.min((elapsed / loadingTime) * 100, 50);

        if (currentPercentage >= 50 && isLoaded) {
          // If it reached 50% and resources are loaded
          clearInterval(loadingInterval);
          document.getElementById("loading-bar-container").style.display = "none";
        } else {
          loadingBar.style.width = currentPercentage + "%";
        }
      }, 100); // Interval - can adjust this as needed
      setTimeout(() => {
        const loadingText = document.getElementById("loading-text");
        const ellipsisInterval = setInterval(function () {
          ellipsisCount = (ellipsisCount + 1) % 4;
          const ellipsis = ".".repeat(ellipsisCount);
          loadingText.innerHTML = "Loading" + ellipsis;
        }, 300); // Interval for ellipsis animation - adjust as needed
      }, 10);
    }

    window.addEventListener(
      "resize",
      function () {
        // Here, you also need to update the camera and the renderer
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      },
      false
    );


  </script>
  <!--   <script type="module" src="dist/assets/index-36d64b46.js"></script> -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const smoothScrollLinks = document.querySelectorAll(".sceneNav a");
      const moreLinks = document.querySelectorAll("#footer-nav a")

      // Create a function to add the smooth scroll behavior
      function addSmoothScroll(element) {
        element.addEventListener("click", function (event) {
          event.preventDefault();
          const targetId = this.getAttribute("href");
          const targetElement = document.querySelector(targetId);

          if (targetElement) { // Make sure the element exists on your page
            targetElement.scrollIntoView({
              behavior: "smooth"
            });
          }
        });
      }

      // Apply the function to each element
      smoothScrollLinks.forEach(addSmoothScroll);
      moreLinks.forEach(addSmoothScroll);
    });

    function adjustTextareaHeight() {
      const textarea = document.getElementById('text');
      textarea.style.height = 'auto'; // Reset height to auto to adjust based on content
      textarea.style.height = textarea.scrollHeight + 'px'; // Set height to scrollHeight
    }
  </script>
  <script src="https://kit.fontawesome.com/b665a46beb.js" crossorigin="anonymous"></script>
  <script src="https://formspree.io/js/formbutton-v1.min.js" defer></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script>
    $(document).ready(function () {
      $('#myForm').on('submit', function (e) {
        e.preventDefault();
        $.ajax({
          url: $(this).attr('action'),
          method: "POST",
          data: $(this).serialize(),
          dataType: "json",
          success: function (data) {
            alert("Your message has been successfully sent.");
          },
          error: function (err) {
            alert("There was an error sending your message. Please try again later.");
          }
        });
      });
    });
  </script>
</body>

</html>